<!DOCTYPE html>
<html lang="zh-cn">

<head>

  
  <meta charset="UTF-8">
  <title>
    HDU 2874 Connections between cities | World of Forks
  </title>


  
  <meta name="viewport" content="width=device-width,user-scalable=no,maximum-scale=1,initial-scale=1">

  
  <link rel="canonical" href="https://stkevintan.github.io/post/hdu-2874-connections-between-cities/" />

  
  
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="//cdn.bootcss.com/highlight.js/9.12.0/styles/ocean.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://stkevintan.github.io/css/styles-d3e13fbeab.css">
  
  <link href="https://stkevintan.github.io/index.xml" rel="alternate" type="application/rss+xml" title="World of Forks" />
  <link href="https://stkevintan.github.io/index.xml" rel="feed" type="application/rss+xml" title="World of Forks" />

  
  <link href="https://stkevintan.github.io/favicon.ico" rel="shortcut icon">
</head>



<body>
  
  <div id="modal1" class="modal">
    <div class="modal-content">
      <form action="//www.google.com/search" method="get" accept-charset="utf-8">
        <input type="hidden" name="sitesearch" value="https://stkevintan.github.io">
        <div class="input-field">
          <input placeholder="Search" id="input-search" name="q" type="text" required aria-required="true"/>
        </div>
    </form>
    </div>
  </div>
  <div class="navbar-fixed">
    <nav class="navbar">
      <div class="nav-wrapper container">
        <a href="#" class="button-collapse"><i class="material-icons">menu</i></a>
        <a href="javascript:void(0)" class="brand-logo"><i class="material-icons">restaurant_menu</i> 
          World of Forks
        </a>

        <ul class="right">
           
          <li ><a class="modal-trigger" href='#modal1'><i class="material-icons">search</i></a></li>
          <li><a href='https://stkevintan.github.io/index.xml' target="_blank" ><i class="material-icons">rss_feed</i></a></li>
        </ul>
        
          <ul class="center tabs tabs-transparent hide-on-med-and-down">
            
            <li class="tab">
              <a href="/" class=' active '>
                Home
              </a>
            </li>
            
            <li class="tab">
              <a href="/archive/" class=''>
                Archive
              </a>
            </li>
            
            <li class="tab">
              <a href="/about/" class=''>
                About
              </a>
            </li>
             
          </ul>
         
      </div>
    </nav>
  </div> <aside class="side-panel">
  <div class="inner">
    <div class="profile">
      <div class="profile__bg" style="background-image:url('/img/profile-bg-7c6e6a1672.jpg')"></div>
      <img class="profile__avatar" src="/img/avatar-66318e716f.png" alt="avatar" /> 
      <h3 class="profile__name">Kevin Tan</h3> 
      <p class="profile__desc">Tempora mutantur, nos et mutamur in illis ...</p>
    </div>
    <ul class="nav-group show-on-medium-and-down menu ">
       
      <li>
        <a class="collapsible-header waves-effect waves-indigo" href="/">
          <i class="material-icons">home</i>
          <span class="content">Home</span>
          <i class="material-icons">chevron_right</i>
        </a>
      </li>
      
      <li>
        <a class="collapsible-header waves-effect waves-indigo" href="/archive/">
          <i class="material-icons">archive</i>
          <span class="content">Archive</span>
          <i class="material-icons">chevron_right</i>
        </a>
      </li>
      
      <li>
        <a class="collapsible-header waves-effect waves-indigo" href="/about/">
          <i class="material-icons">person</i>
          <span class="content">About</span>
          <i class="material-icons">chevron_right</i>
        </a>
      </li>
       
    </ul>
    <ul class="collapsible nav-group" data-collapsible="accordion">
      <li>
        <div class="collapsible-header waves-effect waves-indigo">
          <i class="material-icons">whatshot</i>
          <span class="content">Latest</span>
          <i class="material-icons angle">expand_more</i>
        </div>
        <div class="collapsible-body">
          <div class="collection">
            
            <a class="collection-item" href="https://stkevintan.github.io/post/polymer-2-7-helper-element/">Polymer 2.0 文档笔记(7) Helper Element</a> 
            <a class="collection-item" href="https://stkevintan.github.io/post/polymer-2-6-data-binding/">Polymer 2.0 文档笔记(6) Data Binding</a> 
            <a class="collection-item" href="https://stkevintan.github.io/post/polymer-2-5-observers-and-computed-properties/">Polymer 2.0 文档笔记(5) Observers &amp;&amp; Computed Properites</a> 
            <a class="collection-item" href="https://stkevintan.github.io/post/polymer-2-4-data-system/">Polymer 2.0 文档笔记(4) Data System</a> 
            <a class="collection-item" href="https://stkevintan.github.io/post/polymer-2-3-events/">Polymer 2.0 文档笔记(3) Events</a> 
            <a class="collection-item" href="https://stkevintan.github.io/post/polymer-2-2-shadowdom/">Polymer 2.0 文档笔记(2) ShadowDOM</a> 
            <a class="collection-item" href="https://stkevintan.github.io/post/polymer-2-1-custom-elements/">Polymer 2.0 文档笔记(1) Custom Elements</a> 
            <a class="collection-item" href="https://stkevintan.github.io/post/hello-world/">网易云音乐新API浅析</a> 
            <a class="collection-item" href="https://stkevintan.github.io/post/shadowsocks-account/">Shadowsocks免费账号网址集</a> 
            <a class="collection-item" href="https://stkevintan.github.io/post/asp-net-mvc4note2/">ASP.NET MVC 4笔记（二）</a> 
          </div>
        </div>
      </li>
       
      <li>
        <div class="collapsible-header waves-effect waves-indigo">
          <i class="material-icons">view_list</i>
          <span class="content">Category </span>
          
          <i class="material-icons angle">expand_more</i>
        </div>
        <div class="collapsible-body">
          <div class="collection">
            
            <a class="collection-item" href="https://stkevintan.github.iocategories/acm"> acm<span class="badge">18</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iocategories/web"> web<span class="badge">7</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iocategories/08"> 08<span class="badge">3</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iocategories/07"> 07<span class="badge">2</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iocategories/10"> 10<span class="badge">2</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iocategories/11"> 11<span class="badge">2</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iocategories/02"> 02<span class="badge">1</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iocategories/09"> 09<span class="badge">1</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iocategories/asp.net"> asp.net<span class="badge">1</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iocategories/ide/editor"> ide/editor<span class="badge">1</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iocategories/wine"> wine<span class="badge">1</span></a>            
          </div>
        </div>
      </li>
       
      <li>
        <div class="collapsible-header waves-effect waves-indigo">
          <i class="material-icons">local_offer</i>
          <span class="content">Tag </span>
          
          <i class="material-icons angle">expand_more</i>
        </div>
        <div class="collapsible-body">
          <div class="collection">
            
            <a class="collection-item" href="https://stkevintan.github.iotags/polymer"> polymer<span class="badge">7</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iotags/tarjan"> tarjan<span class="badge">5</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iotags/%E5%9B%BE%E8%AE%BA"> 图论<span class="badge">5</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iotags/lca"> lca<span class="badge">3</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iotags/asp.net-mvc4"> asp.net-mvc4<span class="badge">1</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iotags/c"> c#<span class="badge">1</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iotags/rmq"> rmq<span class="badge">1</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iotags/%E5%80%8D%E5%A2%9E"> 倍增<span class="badge">1</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iotags/%E6%9A%B4%E5%8A%9B"> 暴力<span class="badge">1</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iotags/%E6%A0%91%E5%BD%A2dp"> 树形dp<span class="badge">1</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iotags/%E6%A0%91%E7%9A%84%E7%9B%B4%E5%BE%84"> 树的直径<span class="badge">1</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iotags/%E7%9F%A9%E9%98%B5%E6%9A%B4%E5%8A%9B"> 矩阵暴力<span class="badge">1</span></a>            
          </div>
        </div>
      </li>
      
    </ul>
    <ul class="nav-group external-link">
       
      <li>
        <a class="collapsible-header waves-effect waves-indigo" href="https://github.com/stkevintan" target="_blank">
          <i class="material-icons" data-svg-icon="github">github</i>
          <span class="content">Github<small>@stkevintan</small></span>
          <i class="material-icons">chevron_right</i>
        </a>
      </li>
      
      <li>
        <a class="collapsible-header waves-effect waves-indigo" href="https://twitter.com/kevinsfork" target="_blank">
          <i class="material-icons" data-svg-icon="twitter">twitter</i>
          <span class="content">Twitter<small>@kevinsfork</small></span>
          <i class="material-icons">chevron_right</i>
        </a>
      </li>
      
      <li>
        <a class="collapsible-header waves-effect waves-indigo" href="mailto:stkevintan@zju.edu.cn" target="_blank">
          <i class="material-icons" data-svg-icon="email">email</i>
          <span class="content">E-mail<small>stkevintan@foxmail.com</small></span>
          <i class="material-icons">chevron_right</i>
        </a>
      </li>
       
    </ul>
  </div>
</aside>

<main id="single" role="main" class="main-panel ">
  <section class="container">
    <div class="inner">
       <div class="breadcrumbs" role="navigation" aria-label="breadcrumbs navigation">
   
   
   
  
    <a class="breadcrumb" href="https://stkevintan.github.io"><i class="material-icons">location_on</i>Home</a>
    
       
      
      
      
       
    
       
      
      
      
       
        
          <a class="breadcrumb" href='https://stkevintan.github.io/post/'>Post</a>
         
       
    
       
      
      
      
       
        
          <span class="breadcrumb">HDU 2874 Connections between cities</span>
         
       
    
       
      
      
      
       
     
</div>
      <div class="toc-panel">
        <nav id="TableOfContents">
<ul>
<li><a href="#connections-between-cities">Connections between cities</a></li>
</ul>
</nav>
      </div>
      <div class="post">
        <div class="card">
          <div class="card-content">
            <span class="card-title">HDU 2874 Connections between cities </span>
            <span class="card-meta">
              <time>
                
                <span> 2014-6-14</span>
            </time>
            <address>
              
              <a href="https://stkevintan.github.io/categories/acm">ACM</a>&nbsp; 
              <a href="https://stkevintan.github.io/categories/08">08</a>&nbsp; 
            </address>

            </span>

            <article class="article">
              <h1 id="connections-between-cities">Connections between cities</h1>

<p><strong><span style="font-family: Arial; font-size: 12px; font-weight: bold; color: green;">Time Limit: <sup>10000</sup>&frasl;<sub>5000</sub> MS (Java/Others)    Memory Limit: <sup>32768</sup>&frasl;<sub>32768</sub> K (Java/Others)
Total Submission(s): 4759    Accepted Submission(s): 1341
</span></strong>
<div class="panel_title" align="left">Problem Description</div>
<div class="panel_content">After World War X, a lot of cities have been seriously damaged, and we need to rebuild those cities. However, some materials needed can only be produced in certain places. So we need to transport these materials from city to city. For most of roads had been totally destroyed during the war, there might be no path between two cities, no circle exists as well.
Now, your task comes. After giving you the condition of the roads, we want to know if there exists a path between any two cities. If the answer is yes, output the shortest path between them.</div>

<div class="panel_bottom"></div>
&nbsp;
<div class="panel_title" align="left">Input</div>
<div class="panel_content">Input consists of multiple problem instances.For each instance, first line contains three integers n, m and c, 2&lt;=n&lt;=10000, 0&lt;=m&lt;10000, 1&lt;=c&lt;=1000000. n represents the number of cities numbered from 1 to n. Following m lines, each line has three integers i, j and k, represent a road between city i and city j, with length k. Last c lines, two integers i, j each line, indicates a query of city i and city j.</div>
<div class="panel_bottom"></div>
&nbsp;
<div class="panel_title" align="left">Output</div>
<div class="panel_content">For each problem instance, one line for each query. If no path between two cities, output “Not connected”, otherwise output the length of the shortest path between them.</div>
<div class="panel_bottom"></div>
&nbsp;
<div class="panel_title" align="left">Sample Input</div>
<div class="panel_content">
<div style="font-family: Courier New,Courier,monospace;">5 3 2 1 3 2 2 4 3 5 2 3 1 4 4 5</div>
</div>
<div class="panel_bottom"></div>
&nbsp;
<div class="panel_title" align="left">Sample Output</div>
<div class="panel_content">
<div style="font-family: Courier New,Courier,monospace;">Not connected 6
<div style="font-family: Times New Roman; font-size: 14px; background-color: f4fbff; border: #B7CBFF 1px dashed; padding: 6px;">
<div style="font-family: Arial; font-weight: bold; color: #7ca9ed; border-bottom: #B7CBFF 1px dashed;"><em>Hint</em></div>
Hint Huge input, scanf recommended.</div>
_ _</div>
</div>
<div class="panel_bottom"></div>
&nbsp;
<div class="panel_title" align="left">Source</div>
<div class="panel_content"><a href="http://acm.hdu.edu.cn/search.php?field=problem&amp;amp;key=2009%20Multi-University%20Training%20Contest%208%20-%20Host%20by%20BJNU&amp;amp;source=1&amp;amp;searchmode=source"> 2009 Multi-University Training Contest 8 - Host by BJNU </a></div></p>

<pre><code class="language-C++">#include&amp;lt;map&amp;gt;
#include&amp;lt;set&amp;gt;
#include&amp;lt;cmath&amp;gt;
#include&amp;lt;stack&amp;gt;
#include&amp;lt;queue&amp;gt;
#include&amp;lt;string&amp;gt;
#include&amp;lt;cstdio&amp;gt;
#include&amp;lt;vector&amp;gt;
#include&amp;lt;cctype&amp;gt;
#include&amp;lt;cassert&amp;gt;
#include&amp;lt;utility&amp;gt;
#include&amp;lt;numeric&amp;gt;
#include&amp;lt;cstring&amp;gt;
#include&amp;lt;iostream&amp;gt;
#include&amp;lt;algorithm&amp;gt;
using namespace std;
#define pr pair
#define PR pair&amp;lt;int,int&amp;gt;
#define MP make_pair
#define SI(x) set&amp;lt;x&amp;gt;::iterator
#define VI(x) vector&amp;lt;x&amp;gt;::iterator
#define MI(x,y) map&amp;lt;x,y&amp;gt;::iterator
#define SRI(x) set&amp;lt;x&amp;gt;::reverse_iterator
#define VRI(x) vector&amp;lt;x&amp;gt;::reverse_iterator
#define MRI(x,y) map&amp;lt;x,y&amp;gt;::reverse_iterator
#define F first
#define S second
#define Sz(x) (int)x.size()
#define clrQ(x) while(!x.empty)x.pop();
#define clr(x,y) memset(x,y,sizeof(x));
#if defined (_WIN32) || defined (__WIN32) || defined (WIN32) || defined (__WIN32__)
#define LL __int64
#define LLS &quot;%&quot; &quot;I&quot; &quot;6&quot; &quot;4&quot; &quot;d&quot;
#define LLU &quot;%&quot; &quot;I&quot; &quot;6&quot; &quot;4&quot; &quot;u&quot;
#define LL_MAX _I64_MAX
#else
#define LL long long
#define LLS &quot;%&quot; &quot;l&quot; &quot;l&quot; &quot;d&quot;
#define LLU &quot;%&quot; &quot;l&quot; &quot;l&quot; &quot;u&quot;
#define LL_MAX _I64_MAX
#endif
const int inf = ~0u &amp;gt;&amp;gt; 1;
const LL lnf = ~0ull &amp;gt;&amp;gt; 1;
/*start*/
#define N 10004
#define M 10005
int n, m, c;
struct Edge {
    int v, w, nxt;
} e[M &amp;lt;&amp;lt; 1];
int head[N], ecnt;
void initEdge() {
    memset(head, -1, sizeof(head));
    ecnt = 0;
}
void add(int u, int v, int w) {
    e[ecnt].v = v;
    e[ecnt].w = w;
    e[ecnt].nxt = head[u];
    head[u] = ecnt++;
}
//RMQ
int dpM[20][N &amp;lt;&amp;lt; 1];
int lg2[N &amp;lt;&amp;lt; 1];
#define getL(R,L) (R-(L)+1)
void initRMQ(int n) {
    lg2[0] = -1;
    int m;
    for (int i = 1; i &amp;lt;= n; i++)
        lg2[i] = i &amp;amp; (i - 1) ? lg2[i - 1] : lg2[i - 1] + 1;
    for (int i = 1; i &amp;lt;= lg2[n]; i++) {
        m = getL(n, 1 &amp;lt;&amp;lt; i);
        for (int j = 1; j &amp;lt;= m; j++) {
            dpM[i][j] = min(dpM[i - 1][j], dpM[i - 1][j + (1 &amp;lt;&amp;lt; (i - 1))]);
        }
    }
}
int getRMQ(int a, int b) {
    if (a &amp;gt; b) swap(a, b);
    int s = lg2[b - a + 1];
    return min(dpM[s][a], dpM[s][getL(b, 1 &amp;lt;&amp;lt; s)]);
}
//LCA
int E[N];
int T[N];
int H[N];
int depth, cnt;
int belong[N], bcnt;
int findRoot() {
    for (int i = 1; i &amp;lt;= n; i++) {
        if (belong[i] == 0) return i;
    }
    return -1;
}
void getEuler(int u, int fa = -1) {
    int tmp = dpM[0][H[u] = ++cnt] = ++depth;
    E[tmp] = u;
    belong[u] = bcnt;
    for (int i = head[u]; ~i; i = e[i].nxt) {
        int v = e[i].v;
        if (v == fa) continue;
        T[v] = T[u] + e[i].w;
        getEuler(v, u);
        dpM[0][++cnt] = tmp;
    }
}
void initLCA() {

    memset(T, 0, sizeof(T));
    memset(belong, 0, sizeof(belong));
    bcnt = cnt = depth = 0;
    int root;
    while ((root = findRoot()) != -1) {
        ++bcnt;
        getEuler(root);
    }
    initRMQ(cnt);
}
int getLCA(int u, int v) {
    if (belong[u] != belong[v]) return -1;
    if (H[u] &amp;gt; H[v]) swap(u, v);
    return E[getRMQ(H[u], H[v])];
}
int main(int argc, char **argv) {
    while (~scanf(&quot;%d%d%d&quot;, &amp;amp;n, &amp;amp;m, &amp;amp;c)) {
        initEdge();
        int u, v, w;
        for (int i = 1; i &amp;lt;= m; i++) {
            scanf(&quot;%d%d%d&quot;, &amp;amp;u, &amp;amp;v, &amp;amp;w);
            add(u, v, w);
            add(v, u, w);
        }
        initLCA();
        while (c--) {
            scanf(&quot;%d%d&quot;, &amp;amp;u, &amp;amp;v);
            int r = getLCA(u, v);
            if (r == -1) puts(&quot;Not connected&quot;);
            else {
                printf(&quot;%d\n&quot;, T[u] + T[v] - 2 * T[r]);
            }
        }
    }
}
</code></pre>

<p></pre></p>
            </article>

          </div>
          
          <div class="card-action">
            
 <div class="comments"><div id="disqus_thread"></div></div>

<script type="text/javascript">
     
    var disqus_shortname = 'keyin';

     
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>



          </div>
        </div>
        
          <div class="pagination-single">
             
            <span class="pagination-item previous">
            <i class="material-icons">navigate_before</i>
            <a href="https://stkevintan.github.io/post/zjnu2085/" rel="prev">内网 2085马农</a>
          </span>  
          
            <span class="pagination-item next">
            <i class="material-icons">navigate_next</i>
            <a href="https://stkevintan.github.io/post/hdu-4945-2048/" rel="next">HDU 4945 2048</a> 
          </span> 
          </div>
        
      </div>
    </div>
  </section>
  
<footer class="page-footer">
  <div class="container">
    <div class="row">
      <div class="col l6 s12">
        <h5 class="white-text">World of Forks</h5>
        <p class="grey-text text-lighten-4">Theme <a href="" target="_blank">YAMT</a> designed by <a href="#!">Kevin Tan</a> with ❤</p>
      </div>
      <div class="col l4 offset-l2 s12">
        <h5 class="white-text">My Friends</h5>
        <ul>
          
          <li><a class="grey-text text-lighten-3" href="https://frantic1048.logdown.com/" target="_blank">Frantic1048</a></li>
          
          <li><a class="grey-text text-lighten-3" href="https://hclmaster.github.io/" target="_blank">HclMaster</a></li>
          
          <li><a class="grey-text text-lighten-3" href="https://whst.github.io/" target="_blank">WANG Hsü-Tung</a></li>
          
        </ul>
      </div>
    </div>
  </div>
  <div class="footer-copyright">
    <div class="container">Copyleft@Kevin Tan</div>
  </div>
</footer>




<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script>
  hljs.initHighlightingOnLoad();
</script>
<script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script type="text/javascript" src="/js/materialize.min.js"></script>
<script type="text/javascript" src="/js/index-51aa3898b6.js"></script>





</body>

</html>
</main>