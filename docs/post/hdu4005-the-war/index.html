<!DOCTYPE html><html lang="zh-cn"><head><meta charset="UTF-8"><title>HDU4005 The war | World of Forks</title><meta name="viewport" content="width=device-width,user-scalable=no,maximum-scale=1,initial-scale=1"><link rel="canonical" href="http://keyin.me/post/hdu4005-the-war/"><link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"><link href="//cdn.bootcss.com/highlight.js/9.12.0/styles/ocean.min.css" rel="stylesheet"><link rel="stylesheet" href="http://keyin.me/css/index-63c3fab81a.css"><link href="http://keyin.me/index.xml" rel="alternate" type="application/rss+xml" title="World of Forks"><link href="http://keyin.me/index.xml" rel="feed" type="application/rss+xml" title="World of Forks"><link href="http://keyin.me/favicon.ico" rel="shortcut icon"><script>window.origin = "http://keyin.me"</script></head><body><div id="modal-search" class="modal"><div class="modal-content"><form><div class="row"><div class="input-field col s12"><input id="in-search" type="text" required aria-required="true"><label for="in-search">Search</label></div></div></form><div class="out-wrapper row"><div id="out-search" class="collection col s12"></div></div></div></div><div class="navbar-fixed"><nav class="navbar"><div class="nav-wrapper container"><a href="javascript:void(0)" class="button-collapse"><i class="material-icons">menu</i></a> <a href="http://keyin.me" class="brand-logo"><i class="material-icons">restaurant_menu</i> World of Forks</a><ul class="right hide-on-small-and-down"><li><a class="modal-trigger" href="#modal-search"><i class="material-icons">search</i></a></li><li><a href="http://keyin.me/index.xml" target="_blank"><i class="material-icons">rss_feed</i></a></li></ul><ul class="center tabs tabs-transparent hide-on-med-and-down"><li class="tab"><a href="http://keyin.me/" class="">Home</a></li><li class="tab"><a href="http://keyin.me/archive/" class="">Archive</a></li><li class="tab"><a href="http://keyin.me/about/" class="">About</a></li></ul></div></nav></div><aside class="side-panel"><div class="inner"><div class="profile"><div class="profile__bg" style="background-image:url('http://keyin.me/img/profile-bg-7c6e6a1672.jpg')"></div><img class="profile__avatar" src="http://keyin.me/img/avatar-66318e716f.png" alt="avatar"><h3 class="profile__name">Kevin Tan</h3><p class="profile__desc">Tempora mutantur, nos et mutamur in illis ...</p></div><ul class="nav-group show-on-medium-and-down menu"><li><a class="collapsible-header waves-effect waves-indigo" href="http://keyin.me/"><i class="material-icons">home</i> <span class="content">Home</span> <i class="material-icons">chevron_right</i></a></li><li><a class="collapsible-header waves-effect waves-indigo" href="http://keyin.me/archive/"><i class="material-icons">archive</i> <span class="content">Archive</span> <i class="material-icons">chevron_right</i></a></li><li><a class="collapsible-header waves-effect waves-indigo" href="http://keyin.me/about/"><i class="material-icons">person</i> <span class="content">About</span> <i class="material-icons">chevron_right</i></a></li></ul><ul class="nav-group show-on-small tools"><li><a class="collapsible-header waves-effect waves-indigo modal-trigger" href="#modal-search"><i class="material-icons">search</i> <span class="content">Search</span> <i class="material-icons">chevron_right</i></a></li><li><a class="collapsible-header waves-effect waves-indigo" target="_blank" href="http://keyin.me/index.xml"><i class="material-icons">rss_feed</i> <span class="content">RSS Feed</span> <i class="material-icons">chevron_right</i></a></li></ul><ul class="collapsible nav-group" data-collapsible="accordion"><li><div class="collapsible-header waves-effect waves-indigo"><i class="material-icons">whatshot</i> <span class="content">Latest</span> <i class="material-icons angle">expand_more</i></div><div class="collapsible-body"><div class="collection"><a class="collection-item" href="http://keyin.me/post/polymer-2-7-helper-element/">Polymer 2.0 文档笔记(7) Helper Element</a> <a class="collection-item" href="http://keyin.me/post/polymer-2-6-data-binding/">Polymer 2.0 文档笔记(6) Data Binding</a> <a class="collection-item" href="http://keyin.me/post/polymer-2-5-observers-and-computed-properties/">Polymer 2.0 文档笔记(5) Observers &amp;&amp; Computed Properites</a> <a class="collection-item" href="http://keyin.me/post/polymer-2-4-data-system/">Polymer 2.0 文档笔记(4) Data System</a> <a class="collection-item" href="http://keyin.me/post/polymer-2-3-events/">Polymer 2.0 文档笔记(3) Events</a> <a class="collection-item" href="http://keyin.me/post/polymer-2-2-shadowdom/">Polymer 2.0 文档笔记(2) ShadowDOM</a> <a class="collection-item" href="http://keyin.me/post/polymer-2-1-custom-elements/">Polymer 2.0 文档笔记(1) Custom Elements</a> <a class="collection-item" href="http://keyin.me/post/hello-world/">网易云音乐新API浅析</a> <a class="collection-item" href="http://keyin.me/post/shadowsocks-account/">Shadowsocks免费账号网址集</a> <a class="collection-item" href="http://keyin.me/post/asp-net-mvc4note2/">ASP.NET MVC 4笔记（二）</a></div></div></li><li><div class="collapsible-header waves-effect waves-indigo"><i class="material-icons"><i class="material-icons">class</i></i> <span class="content">Category </span><i class="material-icons angle">expand_more</i></div><div class="collapsible-body"><div class="collection"><a class="collection-item" href="http://keyin.me/categories/acm">acm<span class="badge">18</span></a> <a class="collection-item" href="http://keyin.me/categories/web">web<span class="badge">7</span></a> <a class="collection-item" href="http://keyin.me/categories/08">08<span class="badge">3</span></a> <a class="collection-item" href="http://keyin.me/categories/07">07<span class="badge">2</span></a> <a class="collection-item" href="http://keyin.me/categories/10">10<span class="badge">2</span></a> <a class="collection-item" href="http://keyin.me/categories/11">11<span class="badge">2</span></a> <a class="collection-item" href="http://keyin.me/categories/02">02<span class="badge">1</span></a> <a class="collection-item" href="http://keyin.me/categories/09">09<span class="badge">1</span></a> <a class="collection-item" href="http://keyin.me/categories/asp.net">asp.net<span class="badge">1</span></a> <a class="collection-item" href="http://keyin.me/categories/ide/editor">ide/editor<span class="badge">1</span></a> <a class="collection-item" href="http://keyin.me/categories/wine">wine<span class="badge">1</span></a></div></div></li><li><div class="collapsible-header waves-effect waves-indigo"><i class="material-icons"><i class="material-icons">local_offer</i></i> <span class="content">Tag </span><i class="material-icons angle">expand_more</i></div><div class="collapsible-body"><div class="collection"><a class="collection-item" href="http://keyin.me/tags/polymer">polymer<span class="badge">7</span></a> <a class="collection-item" href="http://keyin.me/tags/tarjan">tarjan<span class="badge">5</span></a> <a class="collection-item" href="http://keyin.me/tags/%E5%9B%BE%E8%AE%BA">图论<span class="badge">5</span></a> <a class="collection-item" href="http://keyin.me/tags/lca">lca<span class="badge">3</span></a> <a class="collection-item" href="http://keyin.me/tags/asp.net-mvc4">asp.net-mvc4<span class="badge">1</span></a> <a class="collection-item" href="http://keyin.me/tags/c">c#<span class="badge">1</span></a> <a class="collection-item" href="http://keyin.me/tags/rmq">rmq<span class="badge">1</span></a> <a class="collection-item" href="http://keyin.me/tags/%E5%80%8D%E5%A2%9E">倍增<span class="badge">1</span></a> <a class="collection-item" href="http://keyin.me/tags/%E6%9A%B4%E5%8A%9B">暴力<span class="badge">1</span></a> <a class="collection-item" href="http://keyin.me/tags/%E6%A0%91%E5%BD%A2dp">树形dp<span class="badge">1</span></a> <a class="collection-item" href="http://keyin.me/tags/%E6%A0%91%E7%9A%84%E7%9B%B4%E5%BE%84">树的直径<span class="badge">1</span></a> <a class="collection-item" href="http://keyin.me/tags/%E7%9F%A9%E9%98%B5%E6%9A%B4%E5%8A%9B">矩阵暴力<span class="badge">1</span></a></div></div></li></ul><ul class="nav-group external-link"><li><a class="collapsible-header waves-effect waves-indigo" href="https://github.com/stkevintan" target="_blank"><svg class="svg-icons svg-icons-github"><use xlink:href="#svg-icons-github"></use></svg> <span class="content">Github<small>@stkevintan</small></span> <i class="material-icons">chevron_right</i></a></li><li><a class="collapsible-header waves-effect waves-indigo" href="https://twitter.com/kevinsfork" target="_blank"><svg class="svg-icons svg-icons-twitter"><use xlink:href="#svg-icons-twitter"></use></svg> <span class="content">Twitter<small>@kevinsfork</small></span> <i class="material-icons">chevron_right</i></a></li><li><a class="collapsible-header waves-effect waves-indigo" href="http://weibo.com/kevinclasky" target="_blank"><svg class="svg-icons svg-icons-sina-weibo"><use xlink:href="#svg-icons-sina-weibo"></use></svg> <span class="content">Weibo<small>@白夜繁星o_O</small></span> <i class="material-icons">chevron_right</i></a></li></ul></div></aside><main id="single" role="main" class="main-panel"><section class="container"><div class="inner"><div class="breadcrumbs" role="navigation" aria-label="breadcrumbs navigation"><a class="breadcrumb" href="http://keyin.me"><i class="material-icons">location_on</i>Home</a> <a class="breadcrumb" href="http://keyin.me/post/">Post</a> <span class="breadcrumb">HDU4005 The war</span></div><section class="post-wrapper"><div class="toc-panel"></div><div class="post"><div class="card"><div class="card-content"><span class="card-title">HDU4005 The war </span><span class="card-meta"><time><span>Thu - 2014/31/316</span></time><address><a href="http://keyin.me/categories/07">07</a>&nbsp;</address></span><article class="article"><p><strong><span style="font-family: Arial; font-size: 12px; font-weight: bold; color: green">Time Limit: <sup>2000</sup>&frasl;<sub>1000</sub> MS (Java/Others)    Memory Limit: <sup>65768</sup>&frasl;<sub>65768</sub> K (Java/Others) Total Submission(s): 1992    Accepted Submission(s): 440</span></strong></p><div class="panel_title" align="left">Problem Description</div><div class="panel_content">In the war, the intelligence about the enemy is very important. Now, our troop has mastered the situation of the enemy&rsquo;s war zones, and known that these war zones can communicate to each other directly or indirectly through the network. We also know the enemy is going to build a new communication line to strengthen their communication network. Our task is to destroy their communication network, so that some of their war zones can&rsquo;t communicate. Each line has its &ldquo;cost of destroy&rdquo;. If we want to destroy a line, we must spend the &ldquo;cost of destroy&rdquo; of this line. We want to finish this task using the least cost, but our enemy is very clever. Now, we know the network they have already built, but we know nothing about the new line which our enemy is going to build. In this condition, your task is to find the minimum cost that no matter where our enemy builds the new line, you can destroy it using the fixed money. Please give the minimum cost. For efficiency, we can only destroy one communication line.</div><div class="panel_bottom"></div>&nbsp;<div class="panel_title" align="left">Input</div><div class="panel_content">The input contains several cases. For each cases, the first line contains two positive integers n, m (1&lt;=n&lt;=10000, 0&lt;=m&lt;=100000) standing for the number of the enemy&rsquo;s war zones (numbered from 1 to n), and the number of lines that our enemy has already build. Then m lines follow. For each line there are three positive integer a, b, c (1&lt;=a, b&lt;=n, 1&lt;=c&lt;=100000), meaning between war zone A and war zone B there is a communication line with the &ldquo;cost of destroy &rdquo; c.</div><div class="panel_bottom"></div>&nbsp;<div class="panel_title" align="left">Output</div><div class="panel_content">For each case, if the task can be finished output the minimum cost, or output ‐1.</div><div class="panel_bottom"></div>&nbsp;<div class="panel_title" align="left">Sample Input</div><div class="panel_content"><div style="font-family: Courier New,Courier,monospace">3 2 1 2 1 2 3 2 4 3 1 2 1 1 3 2 1 4 3</div></div><div class="panel_bottom"></div>&nbsp;<div class="panel_title" align="left">Sample Output</div><div class="panel_content"><div style="font-family: Courier New,Courier,monospace">-1 3<div style="font-family: Times New Roman; font-size: 14px; background-color: f4fbff; border: #B7CBFF 1px dashed; padding: 6px"><div style="font-family: Arial; font-weight: bold; color: #7ca9ed; border-bottom: #B7CBFF 1px dashed"><em>Hint</em></div>For the second sample input: our enemy may build line 2 to 3, 2 to 4, 3 to 4. If they build line 2 to 3, we will destroy line 1 to 4, cost 3. If they build line 2 to 4, we will destroy line 1 to 3, cost 2. If they build line 3 to 4, we will destroy line 1 to 2, cost 1. So, if we want to make sure that we can destroy successfully, the minimum cost is 3.<p></p><p></p></div>&nbsp;<p></p><p></p></div></div><div class="panel_bottom"></div>&nbsp;<div class="panel_title" align="left">Source</div><div class="panel_content"><a href="http://acm.hdu.edu.cn/search.php?field=problem&amp;amp;key=The%2036th%20ACM/ICPC%20Asia%20Regional%20Dalian%20Site%20%E2%80%94%E2%80%94%20Online%20Contest&amp;amp;source=1&amp;amp;searchmode=source">The 36th ACM/ICPC Asia Regional Dalian Site —— Online Contest</a></div><div class="panel_content"></div><div class="panel_content"></div><div class="panel_content">求无向图边双连通分量缩点，然后DP求第二长边。</div><div class="panel_content"><pre class="EnlighterJSRAW" data-enlighter-language="null">//#pragma comment(linker, &ldquo;/STACK:1024000000,1024000000&rdquo;)//C++加栈
#include
#include
#include
#include
#include
#include
#include
#include<map>
#include
#include
#include
using namespace std;
#if defined (_WIN32) || defined (<strong>WIN32) || defined (WIN32) || defined (</strong>WIN32__)
#define LL __int64
#define LLS &ldquo;%&rdquo; &ldquo;I&rdquo; &ldquo;6&rdquo; &ldquo;4&rdquo; &ldquo;d&rdquo;
#define LLU &ldquo;%&rdquo; &ldquo;I&rdquo; &ldquo;6&rdquo; &ldquo;4&rdquo; &ldquo;u&rdquo;
#define LL_MAX _I64_MAX<p></p>

<p>#else
#define LL long long
#define LLS &ldquo;%&rdquo; &ldquo;l&rdquo; &ldquo;l&rdquo; &ldquo;d&rdquo;
#define LLU &ldquo;%&rdquo; &ldquo;l&rdquo; &ldquo;l&rdquo; &ldquo;u&rdquo;
#define LL_MAX _I64_MAX
#endif
#define N 10005
#define M 100005
int n, m;
const int inf = ~0u &gt;&gt; 1;
const LL lnf = ~0ull &gt;&gt; 1;
struct edge {
    int v, w, nxt;
    bool mark;
} e[M &lt;&lt; 1];
struct bridge {
    int u, v, w;
    bridge(int u, int v, int w) {
        this-&gt;u = u;
        this-&gt;w = w;
        this-&gt;v = v;
    }
};
int pos, head[N];
int top, stk[N];
int pre[N], dfs_clock, belong[N], bcnt;
vector brg;
void InitEdge() {
    memset(head, -1, sizeof(head));
    pos = 0;
}
void add(int u, int v, int w) {
    e[pos].v = v;
    e[pos].w = w;
    e[pos].nxt = head[u];
    head[u] = pos++;
}
int dfs(int u,int fa) {
    int lowu = pre[u] = ++dfs_clock;
    stk[top++] = u;
    bool vis=true;
    for (int i = head[u]; ~i; i = e[i].nxt) {
        int v = e[i].v;
        if(v==fa &amp;&amp; vis){
            vis=false;//重边
            continue;
        }
        if (!pre[v]) {
            int lowv = dfs(v,u);
            lowu = min(lowu, lowv);
            if (lowv &gt; pre[u]) { //u-v为桥
                brg.push_back(bridge(u, v, e[i].w));
            }
        } else lowu = min(lowu, pre[v]);
    }
    if (pre[u] == lowu) {
        bcnt++;
        do {
            belong[stk[&ndash;top]] = bcnt;
        } while (stk[top] != u);
    }
    return lowu;
}
void tarjan() {
    top = bcnt = dfs_clock = 0;
    memset(pre, 0, sizeof(pre));
    memset(belong, 0, sizeof(belong));
    brg.clear();
    for (int i = 1; i &lt;= n; i++) {
        if (!pre[i])dfs(i,-1);
    }
}
void rebuild() { //根据桥来缩点重构图
    InitEdge();
    for (int i = 0; i &lt; (int) brg.size(); i++) {
        int u = belong[brg[i].u];
        int v = belong[brg[i].v];
        int w = brg[i].w;
        add(u, v, w);
        add(v, u, w);
    }
}
int res;
int DP(int u, int fa) {
    int Min = inf;
    for (int i = head[u]; ~i; i = e[i].nxt) {
        int v = e[i].v;
        if (v == fa)continue;
        int w = DP(v, u);
        w = min(w, e[i].w);
        if (Min &gt; w) {
            res = min(res, Min);
            Min = w;
        } else res = min(res, w);
    }
    return Min;
}
int main() {
    while (~scanf(&ldquo;%d%d&rdquo;, &amp;n, &amp;m)) {
        int u, v, w;
        InitEdge();
        for (int i = 0; i &lt; m; i++) {
            scanf(&ldquo;%d%d%d&rdquo;, &amp;u, &amp;v, &amp;w);
            add(u, v, w);
            add(v, u, w);
        }
        tarjan();
        rebuild();
        bridge minbrg(-1, -1, inf);
        for (int i = 0; i &lt; (int) brg.size(); i++) {
            if (brg[i].w &lt; minbrg.w) {
                minbrg = brg[i];
            }
        }
        res = inf;
        DP(belong[minbrg.u], belong[minbrg.v]);
        DP(belong[minbrg.v], belong[minbrg.u]);
        if(res==inf)res=-1;
        printf(&ldquo;%d\n&rdquo;, res);
    }
}
</p></map></pre></div><p></p></article></div><div class="card-action"><i class="material-icons">local_offer</i> <a class="tag" href="http://keyin.me/tags/tarjan">#tarjan</a>&nbsp; <a class="tag" href="http://keyin.me/tags/%E6%A0%91%E5%BD%A2dp">#树形DP</a>&nbsp; <a class="tag" href="http://keyin.me/tags/%E5%9B%BE%E8%AE%BA">#图论</a>&nbsp;</div><div class="card-action"><div class="comments"><div id="disqus_thread"></div></div><script type="text/javascript">var disqus_shortname = 'keyin';

     
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript></div></div><div class="pagination-single"><span class="pagination-item previous"><i class="material-icons">navigate_before</i> <a href="http://keyin.me/post/hdu4612-warm-up/" rel="prev">HDU4612 Warm up</a> </span><span class="pagination-item next"><i class="material-icons">navigate_next</i> <a href="http://keyin.me/post/2014-multi-university-training-contest-4/" rel="next">2014 Multi-University Training Contest 4</a></span></div></div></section></div></section><footer class="page-footer"><div class="container"><div class="row"><div class="col l6 s12"><h5 class="white-text">World of Forks</h5><p class="grey-text text-lighten-4">Theme <a href="https://github.com/stkevintan/hugo-YAMT-theme" target="_blank">YAMT</a> designed by <a href="https://github.com/stkevintan" target="_blank">Kevin Tan</a> with ❤</p></div><div class="col l4 offset-l2 s12"><h5 class="white-text">My Friends</h5><ul><li><a class="grey-text text-lighten-3" href="https://frantic1048.logdown.com/" target="_blank">Frantic1048</a></li><li><a class="grey-text text-lighten-3" href="https://hclmaster.github.io/" target="_blank">HclMaster</a></li><li><a class="grey-text text-lighten-3" href="https://whst.github.io/" target="_blank">WANG Hsü-Tung</a></li></ul></div></div></div><div class="footer-copyright"><div class="container">Copyleft@Kevin Tan</div></div></footer></main><script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><script type="text/javascript" src="//cdn.bootcss.com/lunr.js/2.1.2/lunr.min.js"></script><script type="text/javascript" src="http://keyin.me/js/materialize.min.js"></script><script type="text/javascript" src="http://keyin.me/js/index-09d5738f92.js"></script></body></html>