<!DOCTYPE html>
<html lang="zh-cn">

<head>

  
  <meta charset="UTF-8">
  <title>
    ZOJ month contest D.Determinant and Matrix | World of Forks
  </title>


  
  <meta name="viewport" content="width=device-width,user-scalable=no,maximum-scale=1,initial-scale=1">

  
  <link rel="canonical" href="https://stkevintan.github.io/post/zoj-month-contest-d-determinant-and-matrix/" />

  
  
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="//cdn.bootcss.com/highlight.js/9.12.0/styles/ocean.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://stkevintan.github.io/css/styles-d3e13fbeab.css">
  
  <link href="https://stkevintan.github.io/index.xml" rel="alternate" type="application/rss+xml" title="World of Forks" />
  <link href="https://stkevintan.github.io/index.xml" rel="feed" type="application/rss+xml" title="World of Forks" />

  
  <link href="https://stkevintan.github.io/favicon.ico" rel="shortcut icon">
</head>



<body>
  
  <div id="modal1" class="modal">
    <div class="modal-content">
      <form action="//www.google.com/search" method="get" accept-charset="utf-8">
        <input type="hidden" name="sitesearch" value="https://stkevintan.github.io">
        <div class="input-field">
          <input placeholder="Search" id="input-search" name="q" type="text" required aria-required="true"/>
        </div>
    </form>
    </div>
  </div>
  <div class="navbar-fixed">
    <nav class="navbar">
      <div class="nav-wrapper container">
        <a href="#" class="button-collapse"><i class="material-icons">menu</i></a>
        <a href="javascript:void(0)" class="brand-logo"><i class="material-icons">restaurant_menu</i> 
          World of Forks
        </a>

        <ul class="right">
           
          <li ><a class="modal-trigger" href='#modal1'><i class="material-icons">search</i></a></li>
          <li><a href='https://stkevintan.github.io/index.xml' target="_blank" ><i class="material-icons">rss_feed</i></a></li>
        </ul>
        
          <ul class="center tabs tabs-transparent hide-on-med-and-down">
            
            <li class="tab">
              <a href="/" class=' active '>
                Home
              </a>
            </li>
            
            <li class="tab">
              <a href="/archive/" class=''>
                Archive
              </a>
            </li>
            
            <li class="tab">
              <a href="/about/" class=''>
                About
              </a>
            </li>
             
          </ul>
         
      </div>
    </nav>
  </div> <aside class="side-panel">
  <div class="inner">
    <div class="profile">
      <div class="profile__bg" style="background-image:url('/img/profile-bg-7c6e6a1672.jpg')"></div>
      <img class="profile__avatar" src="/img/avatar-66318e716f.png" alt="avatar" /> 
      <h3 class="profile__name">Kevin Tan</h3> 
      <p class="profile__desc">Tempora mutantur, nos et mutamur in illis ...</p>
    </div>
    <ul class="nav-group show-on-medium-and-down menu ">
       
      <li>
        <a class="collapsible-header waves-effect waves-indigo" href="/">
          <i class="material-icons">home</i>
          <span class="content">Home</span>
          <i class="material-icons">chevron_right</i>
        </a>
      </li>
      
      <li>
        <a class="collapsible-header waves-effect waves-indigo" href="/archive/">
          <i class="material-icons">archive</i>
          <span class="content">Archive</span>
          <i class="material-icons">chevron_right</i>
        </a>
      </li>
      
      <li>
        <a class="collapsible-header waves-effect waves-indigo" href="/about/">
          <i class="material-icons">person</i>
          <span class="content">About</span>
          <i class="material-icons">chevron_right</i>
        </a>
      </li>
       
    </ul>
    <ul class="collapsible nav-group" data-collapsible="accordion">
      <li>
        <div class="collapsible-header waves-effect waves-indigo">
          <i class="material-icons">whatshot</i>
          <span class="content">Latest</span>
          <i class="material-icons angle">expand_more</i>
        </div>
        <div class="collapsible-body">
          <div class="collection">
            
            <a class="collection-item" href="https://stkevintan.github.io/post/polymer-2-7-helper-element/">Polymer 2.0 文档笔记(7) Helper Element</a> 
            <a class="collection-item" href="https://stkevintan.github.io/post/polymer-2-6-data-binding/">Polymer 2.0 文档笔记(6) Data Binding</a> 
            <a class="collection-item" href="https://stkevintan.github.io/post/polymer-2-5-observers-and-computed-properties/">Polymer 2.0 文档笔记(5) Observers &amp;&amp; Computed Properites</a> 
            <a class="collection-item" href="https://stkevintan.github.io/post/polymer-2-4-data-system/">Polymer 2.0 文档笔记(4) Data System</a> 
            <a class="collection-item" href="https://stkevintan.github.io/post/polymer-2-3-events/">Polymer 2.0 文档笔记(3) Events</a> 
            <a class="collection-item" href="https://stkevintan.github.io/post/polymer-2-2-shadowdom/">Polymer 2.0 文档笔记(2) ShadowDOM</a> 
            <a class="collection-item" href="https://stkevintan.github.io/post/polymer-2-1-custom-elements/">Polymer 2.0 文档笔记(1) Custom Elements</a> 
            <a class="collection-item" href="https://stkevintan.github.io/post/hello-world/">网易云音乐新API浅析</a> 
            <a class="collection-item" href="https://stkevintan.github.io/post/shadowsocks-account/">Shadowsocks免费账号网址集</a> 
            <a class="collection-item" href="https://stkevintan.github.io/post/asp-net-mvc4note2/">ASP.NET MVC 4笔记（二）</a> 
          </div>
        </div>
      </li>
       
      <li>
        <div class="collapsible-header waves-effect waves-indigo">
          <i class="material-icons">view_list</i>
          <span class="content">Category </span>
          
          <i class="material-icons angle">expand_more</i>
        </div>
        <div class="collapsible-body">
          <div class="collection">
            
            <a class="collection-item" href="https://stkevintan.github.iocategories/acm"> acm<span class="badge">18</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iocategories/web"> web<span class="badge">7</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iocategories/08"> 08<span class="badge">3</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iocategories/07"> 07<span class="badge">2</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iocategories/10"> 10<span class="badge">2</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iocategories/11"> 11<span class="badge">2</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iocategories/02"> 02<span class="badge">1</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iocategories/09"> 09<span class="badge">1</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iocategories/asp.net"> asp.net<span class="badge">1</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iocategories/ide/editor"> ide/editor<span class="badge">1</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iocategories/wine"> wine<span class="badge">1</span></a>            
          </div>
        </div>
      </li>
       
      <li>
        <div class="collapsible-header waves-effect waves-indigo">
          <i class="material-icons">local_offer</i>
          <span class="content">Tag </span>
          
          <i class="material-icons angle">expand_more</i>
        </div>
        <div class="collapsible-body">
          <div class="collection">
            
            <a class="collection-item" href="https://stkevintan.github.iotags/polymer"> polymer<span class="badge">7</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iotags/tarjan"> tarjan<span class="badge">5</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iotags/%E5%9B%BE%E8%AE%BA"> 图论<span class="badge">5</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iotags/lca"> lca<span class="badge">3</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iotags/asp.net-mvc4"> asp.net-mvc4<span class="badge">1</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iotags/c"> c#<span class="badge">1</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iotags/rmq"> rmq<span class="badge">1</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iotags/%E5%80%8D%E5%A2%9E"> 倍增<span class="badge">1</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iotags/%E6%9A%B4%E5%8A%9B"> 暴力<span class="badge">1</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iotags/%E6%A0%91%E5%BD%A2dp"> 树形dp<span class="badge">1</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iotags/%E6%A0%91%E7%9A%84%E7%9B%B4%E5%BE%84"> 树的直径<span class="badge">1</span></a>            
            <a class="collection-item" href="https://stkevintan.github.iotags/%E7%9F%A9%E9%98%B5%E6%9A%B4%E5%8A%9B"> 矩阵暴力<span class="badge">1</span></a>            
          </div>
        </div>
      </li>
      
    </ul>
    <ul class="nav-group external-link">
       
      <li>
        <a class="collapsible-header waves-effect waves-indigo" href="https://github.com/stkevintan" target="_blank">
          <i class="material-icons" data-svg-icon="github">github</i>
          <span class="content">Github<small>@stkevintan</small></span>
          <i class="material-icons">chevron_right</i>
        </a>
      </li>
      
      <li>
        <a class="collapsible-header waves-effect waves-indigo" href="https://twitter.com/kevinsfork" target="_blank">
          <i class="material-icons" data-svg-icon="twitter">twitter</i>
          <span class="content">Twitter<small>@kevinsfork</small></span>
          <i class="material-icons">chevron_right</i>
        </a>
      </li>
      
      <li>
        <a class="collapsible-header waves-effect waves-indigo" href="mailto:stkevintan@zju.edu.cn" target="_blank">
          <i class="material-icons" data-svg-icon="email">email</i>
          <span class="content">E-mail<small>stkevintan@foxmail.com</small></span>
          <i class="material-icons">chevron_right</i>
        </a>
      </li>
       
    </ul>
  </div>
</aside>

<main id="single" role="main" class="main-panel ">
  <section class="container">
    <div class="inner">
       <div class="breadcrumbs" role="navigation" aria-label="breadcrumbs navigation">
   
   
   
  
    <a class="breadcrumb" href="https://stkevintan.github.io"><i class="material-icons">location_on</i>Home</a>
    
       
      
      
      
       
    
       
      
      
      
       
        
          <a class="breadcrumb" href='https://stkevintan.github.io/post/'>Post</a>
         
       
    
       
      
      
      
       
        
          <span class="breadcrumb">ZOJ month contest D.Determinant and Matrix</span>
         
       
    
       
      
      
      
       
     
</div>
      <div class="toc-panel">
        <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#input">Input</a></li>
<li><a href="#output">Output</a></li>
<li><a href="#sample-input">Sample Input</a>
<ul>
<li>
<ul>
<li><a href="#sample-output">Sample Output</a></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</nav>
      </div>
      <div class="post">
        <div class="card">
          <div class="card-content">
            <span class="card-title">ZOJ month contest D.Determinant and Matrix </span>
            <span class="card-meta">
              <time>
                
                <span> 2014-6-8</span>
            </time>
            <address>
              
              <a href="https://stkevintan.github.io/categories/acm">ACM</a>&nbsp; 
            </address>

            </span>

            <article class="article">
              <hr />

<p><center style="color: #000000;"><span style="color: green;">Time Limit: </span>2 Seconds      <span style="color: green;">Memory Limit: </span>65536 KB</center></p>

<hr />

<p>##Description
Recently, LBH is learning the curse linear algebra. Thus he is very interested in matrix and determinant now. In order to practice his ability of solving the problem of linear algebra, he just invent some problems by himself. Once the problems was create, he would solve it immediately. However, he meet a problem that was so hard that he couldn&rsquo;t work out even though racked his brains. The problem was described as follow:</p>

<p>To a integer martix M<sub>nn</sub>(a<sub>ij</sub>), we define two function add(M<sub>nn</sub>(a<sub>ij</sub>))=M<sub>nn</sub>(a<sub>ij</sub> + 1) and sub(M<sub>nn</sub>(a<sub>ij</sub>))=M<sub>nn</sub>(a<sub>ij</sub> - 1) which were exactly like this:

<div style="color: #000000;"><img src="http://acm.zju.edu.cn/onlinejudge/showImage.do?name=DeterminantAndMatrixFig1.png" alt="DeterminantAndMatrixFig1" /></div>
<div style="color: #000000;"><img src="http://acm.zju.edu.cn/onlinejudge/showImage.do?name=DeterminantAndMatrixFig2.png" alt="DeterminantAndMatrixFig2" /></div></p>

<p>According to the martix M<sub>nn</sub>(a<sub>ij</sub>), we can permutate it and get a full permutation set Perm(M<sub>nn</sub>(a<sub>ij</sub>)) = {M<sub>nn</sub>(a<sub>I<sub>i</sub>J<sub>j</sub></sub>)| I and J is a permutation of 1..n }, (Perm(M) is a set, each matrix in Perm(M) is unique). For example:</p>

<div style="color: #000000;">![DeterminantAndMatrixFig3](http://acm.zju.edu.cn/onlinejudge/showImage.do?name=DeterminantAndMatrixFig3.png)</div>

<p>The problem is to get the result of a fomula about an integer matrix M<sub>nn</sub>:</p>

<p><div style="color: #000000;"><img src="http://acm.zju.edu.cn/onlinejudge/showImage.do?name=DeterminantAndMatrixFig4.png" alt="DeterminantAndMatrixFig4" /></div>
<span style="color: #000000;">in which the det(M) meaned to cacluate the determinant of M.</span></p>

<h2 id="input">Input</h2>

<p>There are several test cases.</p>

<p>The first line contains an integer <var>T</var>(<var>T</var> ≤ 100) . Then <var>T</var> test cases follow.</p>

<p>In each test case, the first line contains one integer <var>n</var>(0&lt; <var>n</var>≤ 10). The number means the giving matrix&rsquo;s size is <var>n×n</var></p>

<p>Then there are <var>n</var> lines followed, each line contains <var>n</var> integers <var>a<sub>ij</sub></var>(-10≤ <var>a<sub>ij</sub></var>≤ 10), in the position row <var>i</var>, colum <var>j</var>, it represents the number <var>a<sub>ij</sub>.</var></p>

<h2 id="output">Output</h2>

<p>For each test case, since the result may be very large, output one line with the result modulo 2<sup>30</sup>.</p>

<h2 id="sample-input">Sample Input</h2>

<pre><code>1
2
1 1
1 2
</code></pre>

<h4 id="sample-output">Sample Output</h4>

<pre><code>2
</code></pre>

<p><span style="color: #000000;">Author: </span><strong>LIN, Binghui</strong>
<span style="color: #000000;">Source: </span><strong>ZOJ Monthly, August 2014</strong></p>

<p><br/></p>

<hr />

<p>这道题全场现场只A了一个人。今天我们比赛的时候我A了，挺爽的。</p>

<pre><code class="language-Java">import java.util.Scanner;
import java.math.*;
public class Main {
    static long fact[]=new long[15];
    static long kind;
    static int A[][]=new int[10][10];
    static final BigInteger MOD=BigInteger.valueOf(1&amp;lt;&amp;lt;30);
    static void getKind(int n){
        boolean mark[]=new boolean[10];
        for(int i,j,k,r=0;r&amp;lt;2;r++){
            for (i = 0; i &amp;lt; n; ++ i) mark[i] = false;
            for (i = 0; i &amp;lt; n; ++ i) {
                if (mark[i]) continue;
                int cnt = 0;
                for (j = i; j &amp;lt; n; ++ j) {
                    for (k = 0; k &amp;lt; n; ++ k) {
                        if (r==1&amp;amp;&amp;amp;A[k][i] != A[k][j])break;
                        if(r==0&amp;amp;&amp;amp;A[i][k] != A[j][k])break;
                    }
                    if (k == n) {
                        ++ cnt;
                        mark[j] = true;
                    }
                }
                kind /= fact[cnt];
            }
        }
    }
    public static void main(String[] args){
        Scanner cin=new Scanner(System.in);
        int n,T=cin.nextInt();
        fact[0]=1;
        for(int i=1;i&amp;lt;=10;i++)fact[i]=fact[i-1]*i;
        while(T--&amp;gt;0){
            n=cin.nextInt();
            for(int i=0;i&amp;lt;n;i++){
                for(int j=0;j&amp;lt;n;j++){
                    A[i][j]=cin.nextInt();
                }
            }
            long res=0;
            Matrix matrix=new Matrix(n);
            kind=fact[n]*fact[n];
            getKind(n);
            if(kind%2==1){
                matrix.valueOf(A, 0);
                res=res ^(matrix.Det().mod(MOD).longValue());
            }
            matrix.valueOf(A, 1);
            res=res^(matrix.Det().mod(MOD).longValue());
            matrix.valueOf(A, -1);
            res=res^(matrix.Det().mod(MOD).longValue());
            System.out.println(res);
        }
        cin.close();
    }
}
class Matrix{
    BigInteger M[][]=new BigInteger[10][10];
    BigInteger ZERO,ONE;
    int n;
    Matrix(int n){
        this.n=n;
        ZERO=BigInteger.ZERO;
        ONE=BigInteger.ONE;
    }
    void valueOf(int A[][],int d){
        for(int i=0;i&amp;lt;n;i++){
            for(int j=0;j&amp;lt;n;j++){
                M[i][j]=BigInteger.valueOf(A[i][j]+d);
            }
        }
    }
    BigInteger Det(){
        BigInteger tmp, res = ONE, div = ONE;
        int i, j, k;
        for (i = 0; i &amp;lt; n; ++ i) {
            for (j = i; j &amp;lt; n; ++ j) {
                if (!M[j][i].equals(ZERO)) break;
            }
            if (j == n) return ZERO;
            if (j != i) {
                //res = res.negate();
                for (k = 0; k &amp;lt; n; ++ k) {
                    tmp = M[j][k];
                    M[j][k] = M[i][k];
                    M[i][k] = tmp;
                }
            }
            res = res.multiply(M[i][i]);
            for (j = i + 1; j &amp;lt; n; ++ j) {
                if (M[j][i].equals(ZERO)) continue;
                div = div.multiply(M[i][i]);
                for (k = i + 1; k &amp;lt; n; ++ k) {
                    M[j][k] = M[j][k].multiply(M[i][i]).subtract(M[i][k].multiply(M[j][i]));
                }
            }
        }
        res = res.divide(div);
        if (res.compareTo(ZERO) &amp;lt; 0) res = res.negate();
        return res;
    }
}
</code></pre>

<p></pre></p>
            </article>

          </div>
          
          <div class="card-action">
            
 <div class="comments"><div id="disqus_thread"></div></div>

<script type="text/javascript">
     
    var disqus_shortname = 'keyin';

     
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>



          </div>
        </div>
        
          <div class="pagination-single">
             
            <span class="pagination-item previous">
            <i class="material-icons">navigate_before</i>
            <a href="https://stkevintan.github.io/post/fft-thoughts/" rel="prev">FFT求快速卷积的思考</a>
          </span>  
          
            <span class="pagination-item next">
            <i class="material-icons">navigate_next</i>
            <a href="https://stkevintan.github.io/post/asp-net-mvc4-note1-simplemembership/" rel="next">ASP.NET MVC4笔记（一） 扩展Simplemembership</a> 
          </span> 
          </div>
        
      </div>
    </div>
  </section>
  
<footer class="page-footer">
  <div class="container">
    <div class="row">
      <div class="col l6 s12">
        <h5 class="white-text">World of Forks</h5>
        <p class="grey-text text-lighten-4">Theme <a href="" target="_blank">YAMT</a> designed by <a href="#!">Kevin Tan</a> with ❤</p>
      </div>
      <div class="col l4 offset-l2 s12">
        <h5 class="white-text">My Friends</h5>
        <ul>
          
          <li><a class="grey-text text-lighten-3" href="https://frantic1048.logdown.com/" target="_blank">Frantic1048</a></li>
          
          <li><a class="grey-text text-lighten-3" href="https://hclmaster.github.io/" target="_blank">HclMaster</a></li>
          
          <li><a class="grey-text text-lighten-3" href="https://whst.github.io/" target="_blank">WANG Hsü-Tung</a></li>
          
        </ul>
      </div>
    </div>
  </div>
  <div class="footer-copyright">
    <div class="container">Copyleft@Kevin Tan</div>
  </div>
</footer>




<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script>
  hljs.initHighlightingOnLoad();
</script>
<script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script type="text/javascript" src="/js/materialize.min.js"></script>
<script type="text/javascript" src="/js/index-51aa3898b6.js"></script>





</body>

</html>
</main>