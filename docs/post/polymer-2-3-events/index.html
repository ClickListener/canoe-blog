<!DOCTYPE html><html lang="zh-cn"><head><meta charset="UTF-8"><title>Polymer 2.0 文档笔记(3) Events | World of Forks</title><meta name="viewport" content="width=device-width,user-scalable=no,maximum-scale=1,initial-scale=1"><link rel="canonical" href="http://keyin.me/post/polymer-2-3-events/"><link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"><link href="//cdn.bootcss.com/highlight.js/9.12.0/styles/ocean.min.css" rel="stylesheet"><link rel="stylesheet" href="http://keyin.me/css/index-63c3fab81a.css"><link href="http://keyin.me/index.xml" rel="alternate" type="application/rss+xml" title="World of Forks"><link href="http://keyin.me/index.xml" rel="feed" type="application/rss+xml" title="World of Forks"><link href="http://keyin.me/favicon.ico" rel="shortcut icon"><script>window.origin = "http://keyin.me"</script></head><body><div id="modal-search" class="modal"><div class="modal-content"><form><div class="row"><div class="input-field col s12"><input id="in-search" type="text" required aria-required="true"><label for="in-search">Search</label></div></div></form><div class="out-wrapper row"><div id="out-search" class="collection col s12"></div></div></div></div><div class="navbar-fixed"><nav class="navbar"><div class="nav-wrapper container"><a href="javascript:void(0)" class="button-collapse"><i class="material-icons">menu</i></a> <a href="http://keyin.me" class="brand-logo"><i class="material-icons">restaurant_menu</i> World of Forks</a><ul class="right hide-on-small-and-down"><li><a class="modal-trigger" href="#modal-search"><i class="material-icons">search</i></a></li><li><a href="http://keyin.me/index.xml" target="_blank"><i class="material-icons">rss_feed</i></a></li></ul><ul class="center tabs tabs-transparent hide-on-med-and-down"><li class="tab"><a href="http://keyin.me/" class="">Home</a></li><li class="tab"><a href="http://keyin.me/archive/" class="">Archive</a></li><li class="tab"><a href="http://keyin.me/about/" class="">About</a></li></ul></div></nav></div><aside class="side-panel"><div class="inner"><div class="profile"><div class="profile__bg" style="background-image:url('http://keyin.me/img/profile-bg-7c6e6a1672.jpg')"></div><img class="profile__avatar" src="http://keyin.me/img/avatar-66318e716f.png" alt="avatar"><h3 class="profile__name">Kevin Tan</h3><p class="profile__desc">Tempora mutantur, nos et mutamur in illis ...</p></div><ul class="nav-group show-on-medium-and-down menu"><li><a class="collapsible-header waves-effect waves-indigo" href="http://keyin.me/"><i class="material-icons">home</i> <span class="content">Home</span> <i class="material-icons">chevron_right</i></a></li><li><a class="collapsible-header waves-effect waves-indigo" href="http://keyin.me/archive/"><i class="material-icons">archive</i> <span class="content">Archive</span> <i class="material-icons">chevron_right</i></a></li><li><a class="collapsible-header waves-effect waves-indigo" href="http://keyin.me/about/"><i class="material-icons">person</i> <span class="content">About</span> <i class="material-icons">chevron_right</i></a></li></ul><ul class="nav-group show-on-small tools"><li><a class="collapsible-header waves-effect waves-indigo modal-trigger" href="#modal-search"><i class="material-icons">search</i> <span class="content">Search</span> <i class="material-icons">chevron_right</i></a></li><li><a class="collapsible-header waves-effect waves-indigo" target="_blank" href="http://keyin.me/index.xml"><i class="material-icons">rss_feed</i> <span class="content">RSS Feed</span> <i class="material-icons">chevron_right</i></a></li></ul><ul class="collapsible nav-group" data-collapsible="accordion"><li><div class="collapsible-header waves-effect waves-indigo"><i class="material-icons">whatshot</i> <span class="content">Latest</span> <i class="material-icons angle">expand_more</i></div><div class="collapsible-body"><div class="collection"><a class="collection-item" href="http://keyin.me/post/polymer-2-7-helper-element/">Polymer 2.0 文档笔记(7) Helper Element</a> <a class="collection-item" href="http://keyin.me/post/polymer-2-6-data-binding/">Polymer 2.0 文档笔记(6) Data Binding</a> <a class="collection-item" href="http://keyin.me/post/polymer-2-5-observers-and-computed-properties/">Polymer 2.0 文档笔记(5) Observers &amp;&amp; Computed Properites</a> <a class="collection-item" href="http://keyin.me/post/polymer-2-4-data-system/">Polymer 2.0 文档笔记(4) Data System</a> <a class="collection-item" href="http://keyin.me/post/polymer-2-3-events/">Polymer 2.0 文档笔记(3) Events</a> <a class="collection-item" href="http://keyin.me/post/polymer-2-2-shadowdom/">Polymer 2.0 文档笔记(2) ShadowDOM</a> <a class="collection-item" href="http://keyin.me/post/polymer-2-1-custom-elements/">Polymer 2.0 文档笔记(1) Custom Elements</a> <a class="collection-item" href="http://keyin.me/post/hello-world/">网易云音乐新API浅析</a> <a class="collection-item" href="http://keyin.me/post/shadowsocks-account/">Shadowsocks免费账号网址集</a> <a class="collection-item" href="http://keyin.me/post/asp-net-mvc4note2/">ASP.NET MVC 4笔记（二）</a></div></div></li><li><div class="collapsible-header waves-effect waves-indigo"><i class="material-icons"><i class="material-icons">class</i></i> <span class="content">Category </span><i class="material-icons angle">expand_more</i></div><div class="collapsible-body"><div class="collection"><a class="collection-item" href="http://keyin.me/categories/acm">acm<span class="badge">18</span></a> <a class="collection-item" href="http://keyin.me/categories/web">web<span class="badge">7</span></a> <a class="collection-item" href="http://keyin.me/categories/08">08<span class="badge">3</span></a> <a class="collection-item" href="http://keyin.me/categories/07">07<span class="badge">2</span></a> <a class="collection-item" href="http://keyin.me/categories/10">10<span class="badge">2</span></a> <a class="collection-item" href="http://keyin.me/categories/11">11<span class="badge">2</span></a> <a class="collection-item" href="http://keyin.me/categories/02">02<span class="badge">1</span></a> <a class="collection-item" href="http://keyin.me/categories/09">09<span class="badge">1</span></a> <a class="collection-item" href="http://keyin.me/categories/asp.net">asp.net<span class="badge">1</span></a> <a class="collection-item" href="http://keyin.me/categories/ide/editor">ide/editor<span class="badge">1</span></a> <a class="collection-item" href="http://keyin.me/categories/wine">wine<span class="badge">1</span></a></div></div></li><li><div class="collapsible-header waves-effect waves-indigo"><i class="material-icons"><i class="material-icons">local_offer</i></i> <span class="content">Tag </span><i class="material-icons angle">expand_more</i></div><div class="collapsible-body"><div class="collection"><a class="collection-item" href="http://keyin.me/tags/polymer">polymer<span class="badge">7</span></a> <a class="collection-item" href="http://keyin.me/tags/tarjan">tarjan<span class="badge">5</span></a> <a class="collection-item" href="http://keyin.me/tags/%E5%9B%BE%E8%AE%BA">图论<span class="badge">5</span></a> <a class="collection-item" href="http://keyin.me/tags/lca">lca<span class="badge">3</span></a> <a class="collection-item" href="http://keyin.me/tags/asp.net-mvc4">asp.net-mvc4<span class="badge">1</span></a> <a class="collection-item" href="http://keyin.me/tags/c">c#<span class="badge">1</span></a> <a class="collection-item" href="http://keyin.me/tags/rmq">rmq<span class="badge">1</span></a> <a class="collection-item" href="http://keyin.me/tags/%E5%80%8D%E5%A2%9E">倍增<span class="badge">1</span></a> <a class="collection-item" href="http://keyin.me/tags/%E6%9A%B4%E5%8A%9B">暴力<span class="badge">1</span></a> <a class="collection-item" href="http://keyin.me/tags/%E6%A0%91%E5%BD%A2dp">树形dp<span class="badge">1</span></a> <a class="collection-item" href="http://keyin.me/tags/%E6%A0%91%E7%9A%84%E7%9B%B4%E5%BE%84">树的直径<span class="badge">1</span></a> <a class="collection-item" href="http://keyin.me/tags/%E7%9F%A9%E9%98%B5%E6%9A%B4%E5%8A%9B">矩阵暴力<span class="badge">1</span></a></div></div></li></ul><ul class="nav-group external-link"><li><a class="collapsible-header waves-effect waves-indigo" href="https://github.com/stkevintan" target="_blank"><svg class="svg-icons svg-icons-github"><use xlink:href="#svg-icons-github"></use></svg> <span class="content">Github<small>@stkevintan</small></span> <i class="material-icons">chevron_right</i></a></li><li><a class="collapsible-header waves-effect waves-indigo" href="https://twitter.com/kevinsfork" target="_blank"><svg class="svg-icons svg-icons-twitter"><use xlink:href="#svg-icons-twitter"></use></svg> <span class="content">Twitter<small>@kevinsfork</small></span> <i class="material-icons">chevron_right</i></a></li><li><a class="collapsible-header waves-effect waves-indigo" href="http://weibo.com/kevinclasky" target="_blank"><svg class="svg-icons svg-icons-sina-weibo"><use xlink:href="#svg-icons-sina-weibo"></use></svg> <span class="content">Weibo<small>@白夜繁星o_O</small></span> <i class="material-icons">chevron_right</i></a></li></ul></div></aside><main id="single" role="main" class="main-panel"><section class="container"><div class="inner"><div class="breadcrumbs" role="navigation" aria-label="breadcrumbs navigation"><a class="breadcrumb" href="http://keyin.me"><i class="material-icons">location_on</i>Home</a> <a class="breadcrumb" href="http://keyin.me/post/">Post</a> <span class="breadcrumb">Polymer 2.0 文档笔记(3) Events</span></div><section class="post-wrapper"><div class="toc-panel"><nav id="TableOfContents"><ul><li><ul><li><a href="#normal-events">Normal Events</a><ul><li><a href="#add-annotated-event-listeners">Add annotated event listeners</a></li><li><a href="#add-and-remove-listeners-imperatively">Add and remove listeners imperatively</a></li><li><a href="#fire-custom-events">Fire custom events</a></li></ul></li><li><a href="#event-retargeting">Event Retargeting</a></li><li><a href="#gesture-events">Gesture Events</a></li></ul></li></ul></nav></div><div class="post"><div class="card"><div class="card-content"><span class="card-title">Polymer 2.0 文档笔记(3) Events </span><span class="card-meta"><time><span>Sun - 2017/2/26</span></time><address><a href="http://keyin.me/categories/web">Web</a>&nbsp;</address></span><article class="article"><h2 id="normal-events">Normal Events</h2><blockquote><p>Polymer elements can use the standard DOM APIs for creating, dispatching, and listening for events. Polymer also provides annotated event listeners, which allow you to specify event listeners declaratively as part of the element&rsquo;s DOM template.</p></blockquote><h3 id="add-annotated-event-listeners">Add annotated event listeners</h3><p>这个其实就是在标签上使用on-event属性。</p><pre><code class="language-html">&lt;dom-module id=&quot;x-custom&quot;&gt; 
  &lt;template&gt; 
    &lt;button on-click=&quot;handleClick&quot;&gt;Kick Me&lt;/button&gt; 
  &lt;/template&gt; 
  &lt;script&gt; 
    class XCustom extends Polymer.Element { 
 
static get is() {return 'x-custom'} 
 
handleClick() { 
console.log('Ow!'); 
} 
} 
customElements.define(XCustom.is, XCustom); 
     &lt;/script&gt; 
&lt;/dom-module&gt; 
</code></pre><p>需要注意的有：</p><ol><li>如果添加了手势事件则应当使用<code>on-tap</code>事件代替<code>on-click</code>事件，提供更好的移动浏览器支持。</li><li>因为html属性的限制，所有的事件名称都将转化为小写字母。(To avoid confusion, always use lowercase event names. )</li></ol><h3 id="add-and-remove-listeners-imperatively">Add and remove listeners imperatively</h3><p>直接使用原生的<code>addEventListener</code>和<code>removeEventListener</code></p><h3 id="fire-custom-events">Fire custom events</h3><p>直接使用原生的<code>CustomEvent</code>和<code>dispatchEvent</code></p><h2 id="event-retargeting">Event Retargeting</h2><ol><li>为了保持ShadowDOM的隐蔽性。元素内部ShadowDOM触发的一些事件在网上传播时会将target重定向到当前元素。</li><li><code>event.composedPath()</code> : 包含事件传递过程中所经过的nodes路径列表。</li></ol><p>自定义的事件默认无法穿透ShadowDOM边界。可以如下设置：</p><pre><code class="language-javascript">var event = new CustomEvent('my-event', {bubbles: true, composed: true});
</code></pre><h2 id="gesture-events">Gesture Events</h2><p>手势事件的支持是基于Legacy Element的，如果使用Polymer2的class风格定义需要使用mixin:<code>Polymer.GestureEventListeners</code></p><pre><code class="language-html">&lt;link rel=&quot;import&quot; href=&quot;polymer/lib/mixins/gesture-event-listeners.html&quot;&gt; 
 
&lt;script&gt; 
    class TestEvent extends Polymer.GestureEventListeners(Polymer.Element) { 
      ... 
&lt;/script&gt; 
</code></pre><p>注册事件也有两种方式： 1. 支持on-event形式的声明方式 2. 显示定义的方式：<code>Polymer.Gestures.addListener(this, 'tap', e =&gt; this.tapHandler(e));</code></p><p>包含以下几种手势事件，包含在e.detail中。</p><ul><li>down—finger/button went down<ul><li><code>x</code>—clientX coordinate for event</li><li><code>y</code>—clientY coordinate for event</li><li><code>sourceEvent</code>—the original DOM event that caused the down action</li></ul></li><li>up—finger/button went up<ul><li><code>x</code>—clientX coordinate for event</li><li><code>y</code>—clientY coordinate for event</li><li><code>sourceEvent</code>—the original DOM event that caused the up action</li></ul></li><li>tap—down &amp; up occurred<ul><li><code>x</code>—clientX coordinate for event</li><li><code>y</code>—clientY coordinate for event</li><li><code>sourceEvent</code>—the original DOM event that caused the tap action</li></ul></li><li>track—moving while finger/button is down<ul><li><code>state</code>—a string indicating the tracking state:</li><li><code>start</code>—fired when tracking is first detected (finger/button down and moved past a pre-set distance threshold)</li><li><code>track</code>—fired while tracking</li><li><code>end</code>—fired when tracking ends</li><li><code>x</code>—clientX coordinate for event</li><li><code>y</code>—clientY coordinate for event</li><li><code>dx</code>—change in pixels horizontally since the first track event</li><li><code>dy</code>—change in pixels vertically since the first track event</li><li><code>ddx</code>—change in pixels horizontally since last track event</li><li><code>ddy</code>—change in pixels vertically since last track event</li><li><code>hover()</code>-a function that may be called to determine the element currently being hovered</li></ul></li></ul></article></div><div class="card-action"><i class="material-icons">local_offer</i> <a class="tag" href="http://keyin.me/tags/polymer">#Polymer</a>&nbsp;</div><div class="card-action"><div class="comments"><div id="disqus_thread"></div></div><script type="text/javascript">var disqus_shortname = 'keyin';

     
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript></div></div><div class="pagination-single"><span class="pagination-item previous"><i class="material-icons">navigate_before</i> <a href="http://keyin.me/post/polymer-2-2-shadowdom/" rel="prev">Polymer 2.0 文档笔记(2) ShadowDOM</a> </span><span class="pagination-item next"><i class="material-icons">navigate_next</i> <a href="http://keyin.me/post/polymer-2-4-data-system/" rel="next">Polymer 2.0 文档笔记(4) Data System</a></span></div></div></section></div></section><footer class="page-footer"><div class="container"><div class="row"><div class="col l6 s12"><h5 class="white-text">World of Forks</h5><p class="grey-text text-lighten-4">Theme <a href="https://github.com/stkevintan/hugo-YAMT-theme" target="_blank">YAMT</a> designed by <a href="https://github.com/stkevintan" target="_blank">Kevin Tan</a> with ❤</p></div><div class="col l4 offset-l2 s12"><h5 class="white-text">My Friends</h5><ul><li><a class="grey-text text-lighten-3" href="https://frantic1048.logdown.com/" target="_blank">Frantic1048</a></li><li><a class="grey-text text-lighten-3" href="https://hclmaster.github.io/" target="_blank">HclMaster</a></li><li><a class="grey-text text-lighten-3" href="https://whst.github.io/" target="_blank">WANG Hsü-Tung</a></li></ul></div></div></div><div class="footer-copyright"><div class="container">Copyleft@Kevin Tan</div></div></footer></main><script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><script type="text/javascript" src="//cdn.bootcss.com/lunr.js/2.1.2/lunr.min.js"></script><script type="text/javascript" src="http://keyin.me/js/materialize.min.js"></script><script type="text/javascript" src="http://keyin.me/js/index-09d5738f92.js"></script></body></html>